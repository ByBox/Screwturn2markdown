
## SQLServer
1 Scaricare dal sito oracle il setup di Oracle Database Gateway<br>
2 Installarlo in una sua home directory (nel nostro esempio usiamo C:\product\11.1.0\tg_1)<br>
3 Andare in C:\product\11.1.0\tg_1 nella cartella dg4sql ed aprire il file initSID.ora (ovvero inidg4msql.ora)<br>

    
    
    # This is a customized agent init file that contains the HS parameters
    # that are needed for the Database Gateway for Microsoft SQL Server
    
    #
    # HS init parameters
    #
    HS_FDS_CONNECT_INFO=OLIMPO
    HS_FDS_TRACE_LEVEL=OFF
    HS_FDS_RECOVERY_ACCOUNT=RECOVER
    HS_FDS_RECOVERY_PWD=RECOVER
    


In questo file l'unico valore messo da noi e' OLIMPO che e' il nome dell'istanza SQL Server.


4 Configurare il listener del gateway

     
    
    LISTENER_MSSQL =
      (DESCRIPTION_LIST =
        (DESCRIPTION =
          (ADDRESS = (PROTOCOL = TCP)(HOST = nassau.apex-net.it)(PORT = 1525))
          (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1525))
        )
      )
    
    
    SID_LIST_LISTENER_MSSQL=
      (SID_LIST=
          (SID_DESC=
             (SID_NAME=dg4msql)
             (ORACLE_HOME=C:\product\11.1.0\tg_1)
             (PROGRAM=dg4msql)
          )
      )
    


La riga (SID_NAME=dg4msql) identifica la cartella dg4msql sopra descritta.


5 Aggiungere una entry nel tnsnames del client Oracle da cui collegarsi:

    
    
    NASSAU_MSSQL =
      (DESCRIPTION =
        (ADDRESS_LIST =
          (ADDRESS = (PROTOCOL = TCP)(HOST = nassau)(PORT = 1525))
        )
        (CONNECT_DATA =
          (SID = dg4msql)
        )
       (HS=OK)
      )  
    



6 Creare il database link sullo schema interessato

     SQL
    CREATE DATABASE LINK KIM_OLIMPO
     CONNECT TO CRM_GAT
     IDENTIFIED BY CRM_GAT
     USING 'KIM';




## MySql

1. Installare i driver ODBC di Mysql sulla macchina che ospitera' il gateway.
2. Creare un profile ODBC che punta al database Mysql
3. Nella cartella $ORACLE_HOME\hs\admin\ creare il file initdg4odbc.ora con questo contenuto:

     
    # This is a sample agent init file that contains the HS parameters that are
    # needed for the Database Gateway for ODBC
    
    #
    # HS init parameters
    #
    HS_FDS_CONNECT_INFO = RIOMYSQL
    HS_FDS_TRACE_LEVEL = 0
    
    
    #
    # Environment variables required for the non-Oracle system
    #
    #set <envvar>=<value>
    


dove RIOMYSQL e' il nome del profilo odbc creato

4. Creare con l'interfaccio di Oracle un nuovo listener. Esempio di listener.ora:

    
    
    # listener.ora Network Configuration File: C:\product\11.1.0\tg_1\NETWORK\ADMIN\listener.ora
    # Generated by Oracle configuration tools.
    
    
    SID_LIST_LISTENER_MYSQL =
      (SID_LIST =
        (SID_DESC =
          (PROGRAM = dg4odbc)
          (SID_NAME = dg4odbc)
          (ORACLE_HOME = C:\product\11.1.0\tg_1)
        )
      )
    
    LISTENER_MYSQL =
      (DESCRIPTION =
        (ADDRESS = (PROTOCOL = TCP)(HOST = nassau.apex-net.it)(PORT = 1526))
      )
    



5. Creare la riga nel tnsnames.ora del client. Esempio:

    
    
    
    
    RIOMYSQL = 
      (DESCRIPTION =
        (ADDRESS_LIST =
          (ADDRESS = (PROTOCOL = TCP)(HOST = nassau)(PORT = 1526))
        )
        (CONNECT_DATA =
          (SID = dg4odbc)
        )
       (HS=OK)
      )  
    



6. Creare il dblink. Esempio:

     SQL
    
    create database link RIO_MYSQL connect to "utente" identified by "password" using 'RIOMYSQL'
    


a questo punto e' possibile iniziare a scrivere le query.
Ricordarsi di mettere fra apici il nome delle colonne / tabelle di mysql

7. Se hai errore
     SQL
    
    DECLARE
        ret INTEGER;
        c INTEGER;
    BEGIN
        c := DBMS_HS_PASSTHROUGH.OPEN_CURSOR@RIO_MYSQL;
        DBMS_HS_PASSTHROUGH.PARSE@RIO_MYSQL(c, 'SET SESSION SQL_MODE=ANSI_QUOTES');
        ret := DBMS_HS_PASSTHROUGH.EXECUTE_NON_QUERY@RIO_MYSQL(c);
        dbms_output.put_line(ret ||' passthrough output');
        DBMS_HS_PASSTHROUGH.CLOSE_CURSOR@RIO_MYSQL(c);
    END;
    /
    


8. Riferimenti

* <http://it.toolbox.com/blogs/oracle-guide/oracle-connections-to-nonoracle-databases-23797>
* [http://birijan.com.np/?q=Oracle+Heterogeneous+Services+(Accessing+ODBC+datasource)](http://birijan.com.np/?q=Oracle+Heterogeneous+Services+(Accessing+ODBC+datasource))
* Su metalink articolo: 466225.1

